[
  {
    "path": "portfolio/",
    "title": "Task 3 - Acid Rain Effects on Maple Growth",
    "description": {},
    "author": [
      {
        "name": "Logan Ossentjuk",
        "url": {}
      }
    ],
    "date": "2022-02-22",
    "categories": [],
    "contents": "\nOverview\nThis report investigates data collected between 1981 and 2017 on the survival and growth rates of palmetto species (Serenoa repens and Sabal etonia) at the Archbold Biological Station in South Florida. A binary logistic regression analysis is completed based upon features key to palmetto growth. These key variables are found via data visualization and examination. AIC analysis 10-fold cross validation are then performed. The models are trained on the entire data set and results are used to determine which is more comprehensive and accurate.\nData citation: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5 Get the data: palmetto.csv More information and metadata: https://portal.edirepository.org/nis/metadataviewer?packageid=edi.317.1\n\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(here)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(patchwork)\nlibrary(lubridate)\nlibrary(kableExtra) \nlibrary(ggbeeswarm)\nlibrary(GGally)\nlibrary(jtools)\nlibrary(caret)\nlibrary(AICcmodavg)\nlibrary(broom)\n\n\n\nData Visualization:\nPerformed to determine variables of importance\n\n\n###Wrangling and subsetting \npalmetto <- read_csv(here('_portfolio', 'data', 'palmetto.csv')) %>% \n  clean_names()\n\npalmetto_exp <- palmetto %>% \n  mutate(species = as.character(species)) %>% \n  select(height, length, width, green_lvs, species) %>% \n  drop_na() %>% \n  ggpairs(aes(color = species))\n#palmetto_sub\n\npalmetto_sub <-palmetto %>% \n  mutate(species = as.factor(species)) %>% \n  select(height, length, width, green_lvs, species) %>% \n  drop_na()\n\n\n\n\n\n### Figures\n\np1 <- ggplot(data = palmetto_sub, aes (x = species, y = height)) + \n  geom_boxplot(aes(fill = species, width = 0.2)) + \n   stat_summary(fun=mean, \n               geom=\"point\", \n               shape=20, \n               size=4, \n               color=\"white\", \n               fill=\"red\") +\n   scale_fill_manual(values = c(\"skyblue\", \"forestgreen\"), \n                    name = \"Species\") +\n  facet_wrap(~species) +\n  theme_classic() + \n  theme(legend.position = \"none\") +\n  labs( x = \"Species\", \n        y = \"Height\")\n\np2 <- ggplot(data = palmetto_sub, aes (x = species, y = green_lvs)) + \n  geom_boxplot(aes(fill = species, width = 0.2)) +\n  stat_summary(fun=mean, \n               geom=\"point\", \n               shape=20, \n               size=4, \n               color=\"white\", \n               fill=\"red\") +\n  scale_fill_manual(values = c(\"skyblue\",\"forestgreen\"), \n                     name = \"Species\") +\n   facet_wrap(~species) +\n   theme_classic() + \n  theme(legend.position = \"none\") +\n  labs( x = \"Species \", \n        y = \"Green Leaf Cover\")\n\np3 <- ggplot(data = palmetto_sub, aes(x = species, y = length)) + \n  geom_boxplot(aes(fill = species, width = 0.2)) + \n  stat_summary(fun=mean, \n               geom=\"point\", \n               shape=20, \n               size=4, \n               color=\"white\", \n               fill=\"red\") +\n   scale_fill_manual(values = c(\"skyblue\", \"forestgreen\"), \n                    name = \"Species\") +\n  facet_wrap(~species) +\n  theme_classic() + \n  theme(legend.position = \"none\") +\n  labs( x = \"Species\", \n        y = \"Length\")\n\np1 | p2 | p3 \n\n\n\n\nFigure 1: compares the ability for three measured variables on Palmetto canopy (Height, Green Leaf Percent, Length) to differentiate between two species. Species 1 (Serenoa repens), Species 2 (Sabal etonia).\nTakeaway: Given the above figure, green leaf cover and canopy length are the best predictor variables for differentiating between species. The displayed differences median (black line), mean (white dot) and spread are most significant between species for these variables. Plant height is shown to be nearly identical between species and is therefore a poor differentiator.\nBinary Logistic Regression\n\n\nbinary_palmetto <- palmetto_sub %>% \n  mutate( species = case_when(species %in% c('1') ~ 'Serenoa repens',\n                              species %in% c('2') ~ 'Sabal etonia')) %>% \n  filter(species %in% c('Serenoa repens', 'Sabal etonia')) %>% \n  mutate(species = fct_drop(species)) %>% \n  #select(-island, -year) %>%  \n  drop_na()\n\n\n\n\n\n### Model 1\n\nf1 <- species ~ height + length + width + green_lvs\n\npalmetto_blr1 <- glm(formula = f1, \n                    data = binary_palmetto,\n                    family = 'binomial')\n\n### See results\n\n#palmetto_blr1\n\n#summary(palmetto_blr1)\n\nblr1_tidy1 <- broom::tidy(palmetto_blr1)\n\nblr1_fitted <- palmetto_blr1 %>% \n  broom::augment(type.predict = 'response')\n\n### Model 2\nf2 <- species ~ height + width + green_lvs\n\npalmetto_blr2 <- glm(formula = f2, \n                    data = binary_palmetto,\n                    family = 'binomial')\n\n#palmetto_blr2\n\n#summary(palmetto_blr2)\n\nblr1_tidy2 <- broom::tidy(palmetto_blr2)\n\nblr2_fitted <- palmetto_blr2 %>% \n  broom::augment(type.predict = 'response')\n\n\n\nModel Training and Selection\nModel 1: Determines Palmetto species based on height canopy length, canopy width and green leaf cover\nModel 2: Determines Palmetto species based on height, canopy width and green leaf cover\nAIC values\n\n\npalmetto_aic <- AICcmodavg::aictab(list(palmetto_blr1, palmetto_blr2))\n#Mod 1: 5194.567\n#Mod 2: 5194.567\n\n\n\n10-fold cross validation, use prediction accuracy as our metric\n\n\nset.seed(333)\n\ntr_ctrl <- trainControl(method = 'repeatedcv', number = 10, repeats = 10)\n\n### Train the model \n\nmodel1 <- train(f1, data = palmetto_sub,\n                method = 'glm', family = 'binomial',\n                trControl = tr_ctrl)\n# model1\n# accuracy: 0.9168912\n\nmodel2 <- train(f2, data = palmetto_sub,\n                method = 'glm', family = 'binomial',\n                trControl = tr_ctrl)\n# model2\n# accuracy: 0.8988258\n\n\n\nModel 1 AIC: 5194.57\nModel 2 AIC: 5987.48\nResults: Model 1 superiorly selects the correct Palmetto species given inputs (AIC: 5194.57, Accuracy = 92%) as compared to Model 2 (AIC: 5987.48, Accuracy = 90%, Delta AIC = 792.9). Given these differences Model 1 is clearly the superior option.\n\n\npalmetto_blr1_tidy <- broom::tidy(palmetto_blr1) %>% \n  mutate(term = case_when(\n         term == \"(Intercept)\" ~ \"Intercept\",\n         term == \"height\" ~ \"Height\",\n         term == \"length\" ~ \"Length\",\n         term == \"width\" ~ \"Width\",\n         term == \"green_lvs\" ~ \"Green Leaf Cover\"))\n\npalmetto_blr1_tidy %>% \n  mutate(p.value = ifelse(p.value < .005, paste(\"<0.005\"))) %>% \n  kable(digits = 3, col.names = c('Term', 'Estimate', 'Standard Error', 'Statistic', 'P Value'), caption = '<center/>Table 1: Summary of variable coeffiencents and their statistical significance. All p values <0.001.<\/center>') %>%\n          kable_classic(bootstrap_options = 'striped', full_width = FALSE)\n\n\n\nTable 1: \n\n\nTable 1: Summary of variable coeffiencents and their statistical significance. All p values <0.001.\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\nP Value\n\n\nIntercept\n\n\n-3.227\n\n\n0.142\n\n\n-22.712\n\n\n<0.005\n\n\nHeight\n\n\n0.029\n\n\n0.002\n\n\n12.670\n\n\n<0.005\n\n\nLength\n\n\n-0.046\n\n\n0.002\n\n\n-24.556\n\n\n<0.005\n\n\nWidth\n\n\n-0.039\n\n\n0.002\n\n\n-18.782\n\n\n<0.005\n\n\nGreen Leaf Cover\n\n\n1.908\n\n\n0.039\n\n\n49.107\n\n\n<0.005\n\n\nConclusion: All p values were shown to be significant, but the Estimate value gives a better measure here of variable effectiness. Height 1.91 and leaf cover show strong positive relationships meaning it is more likely that the species is Serenoa repens (reference species) as each individual variable changes when everything else stays constant.\nModel 1 Prediction Success Rate\n\n\npalmetto_blr1_fitted <- palmetto_blr1 %>% \n  augment(type.predict = \"response\") %>% \n  mutate(classify_species = case_when(\n    .fitted > .5 ~ \"Serenoa repens\", \n    .fitted < .5 ~ \"Sabal etonia\"), \n  success = case_when(\n    species == classify_species ~ 'yes',\n    species != classify_species ~ 'no'\n  ))\n\nsum_success <- palmetto_blr1_fitted %>% \n  group_by(species, success) %>% \n  summarize(count = n()) %>% \n  pivot_wider(names_from = success,\n              values_from = count) %>% \n  mutate(percent_correct = yes/(no+yes) *100)\n\nsum_success %>% \n  kable(col.names = c('Species',\n                      'Incorrect',\n                      'Correct',\n                      '%Correctly Classified'),\n        caption = '**Table 2: Model 1 success rate at differentiating Palmetto species after trained on entire dataset') %>% \n  kable_classic(full_width = FALSE)\n\n\n\nTable 2: **Table 2: Model 1 success rate at differentiating Palmetto species after trained on entire dataset\n\n\nSpecies\n\n\nIncorrect\n\n\nCorrect\n\n\n%Correctly Classified\n\n\nSabal etonia\n\n\n454\n\n\n5701\n\n\n92.62388\n\n\nSerenoa repens\n\n\n564\n\n\n5548\n\n\n90.77225\n\n\nConclusion: Model 1 is the most effective in determining whether a Palmetto species is Serenoa repens or Sabal etonia when given height, canopy width and length, and green leaf cover. It determines each species with high accuracy (Serenoa repens = 92.6, Sabal etonia = 90.8). With a relatively constrained data set these are incredible results, however future work should be done to improve classification accuracy and train the model on future data.\nData citation: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5 Get the data: palmetto.csv\n\n\n\n",
    "preview": "portfolio/WorkExample_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-02-22T13:12:31-08:00",
    "input_file": {}
  }
]
