[
  {
    "path": "posts/2022-03-14-project3/",
    "title": "Parameter Estimation With Purr",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Logan Ossentjuk",
        "url": {}
      }
    ],
    "date": "2022-03-14",
    "categories": [],
    "contents": "\nOverview\n\n\ncode\n\nlizards <- read_csv(here(\"_posts\", \"data\", \"lizard.csv\")) %>% \n  mutate(sex = case_when(sex == 'M' ~ 'Male',\n                         sex == 'F' ~ 'Female')) %>% \n  clean_names() %>% \n  #Log Transformation\n  mutate(log_weight = log(weight)) %>% \n  mutate(log_length = log(sv_length)) %>% \n  drop_na()\n\n\n\n\\[\nW=a(SVL)^b\n\\]\nW: Weight (g),\nSVL: Snout to vent length (mm),\na and b: the parameters that need to be fitted.\n\n\ncode\n\n# Supply NLS with regression coefficients\n\ncf <- coefficients(model_guess)\n\n#Parameter b (length) guessed as 2.54, a calculated using `exp()`\nlizards_nls <- nls(weight ~ lizards_model(a, sv_length, b),\n                  data = lizards,\n                  start = list(a = exp(cf[1]),\n                               b = cf[2]))\n\n\n\n\n\ncode\n\n### Create Table \ntidy_nls <- tidy(lizards_nls)\n\ntidy_nls$p.value <- ifelse(tidy_nls$p.value < .001, paste(\"< .001\"))\n\ntidy_nls %>% \n  select(-statistic) %>% \nkable(col.names = c(\"Terms\", \"Coefficients\", \"Standard Error\", \"p Value\"), caption = \"**Table 1: ** NSL Model Variable Significance\", digits = 3) %>% \n  kable_classic(bootstrap_options = \"striped\", full_width = FALSE) \n\n\n\nTable 1: Table 1:  NSL Model Variable Significance\n\n\nTerms\n\n\nCoefficients\n\n\nStandard Error\n\n\np Value\n\n\na\n\n\n0.000\n\n\n0.000\n\n\n< .001\n\n\nb\n\n\n2.453\n\n\n0.027\n\n\n< .001\n\n\n\n\ncode\n\nmodel_predict <- augment(lizards_nls)\n\n# Plotting predicted data given NLS\nggplot() +\n   geom_point(data = lizards, \n             aes(x = sv_length, \n                y = weight, \n                color = sex)) +\n   geom_line(data = model_predict, \n             aes(x = sv_length,\n                 y = .fitted,\n                 color = \"Model Predictions\")) +\n  scale_color_manual(values = c(\"pink\", \"skyblue\", \"black\")) +\n  theme_classic() +\n  theme(legend.title = element_blank()) +\n  labs( x = \"SV Length (mm)\", y = \"Weight (g)\")\n\n\n\n\nFigure 1. Displays the predicted non-linear square model for SV Length (mm) versus Weight (g). Female lizards are represented by pink points, Male by blue and the black line represents the trained NLS model to predict Weight given SV Length.\n\n\ncode\n\n### Preparation for Table \n\n### Filter for male Western Whiptails \n\nlizards_m_whip <- lizards %>% \n  filter(sex == \"Male\", spp == \"CNTI\")\n\n\n\n### Create model for subset\nguess_m_whip <- lm(log_weight ~ log_length, data = lizards_m_whip)\n\n#tidy_guess_m_whip <- tidy(guess_m_whip)\n\nm_whip_cf <- coefficients(guess_m_whip)\n\nm_whip_nls <- nls(weight ~ lizards_model(a, sv_length, b),\n                  data = lizards_m_whip,\n                  start = list(a = exp(m_whip_cf[1]),\n                               b = m_whip_cf[2]))\n\ntidy_m_whip_nls <- tidy(m_whip_nls) # tidy output of model\n\n#Calculate RMSE \nlizards_rmse <- rmse(lizards_nls, data = lizards)\nlizards_m_whip_rmse <- rmse(m_whip_nls, data = lizards_m_whip)\n\n\n\n\n\ncode\n\n### Table of Male Whiptail NLS Model\ntidy_m_whip_nls %>%  \n  mutate(p.value = case_when(\n    p.value < 0.001 ~ \"<0.001\",\n    p.value > 0.001 ~ (as.character(round(p.value, 3))))) %>% \n  kable(col.names = c(\"Term\", \n                      \"Estimate\",\n                      \"Standard Error\", \n                      \"Statistic\", \n                      \"p Value\"), caption = \"**Table 2:** NSL Model Variable Significance \", digits = 3) %>% \n  kable_classic(bootstrap_options = \"striped\", full_width = FALSE)\n\n\n\nTable 2: Table 2: NSL Model Variable Significance\n\n\nTerm\n\n\nEstimate\n\n\nStandard Error\n\n\nStatistic\n\n\np Value\n\n\na\n\n\n0.001\n\n\n0.00\n\n\n1.240\n\n\n0.219\n\n\nb\n\n\n2.368\n\n\n0.18\n\n\n13.155\n\n\n<0.001\n\n\n\n\ncode\n\n#Generate predictions based on model\n\nm_whip_predict <- augment(m_whip_nls)\n\n#Create a complete data frame\nm_whip_complete <- data.frame(lizards, model_predict) %>% \n  filter(sex == \"Male\", spp == \"CNTI\")\n\n#Calculate RMSE\nm_whip_rmse <- rmse(m_whip_nls, data = lizards_m_whip)\nlizards_complete_rmse <- rmse(lizards_nls, data = lizards_m_whip)\n\n# Graphing model fits given NLS\nggplot() +\n  geom_point(data = lizards_m_whip, \n             aes(\n               x = sv_length,\n               y = weight,\n               color = \"Actual Data\")) +\n  geom_line(data = m_whip_predict, \n            aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"Male Whiptails Model\")) +\n  geom_line(data = m_whip_complete, \n            aes(\n            x = sv_length,\n            y = .fitted,\n            color = \"All Lizards Model\")) +\n  scale_color_viridis_d() +\n  theme_classic() +\n  labs( x = \"SV Length (mm)\", y = \"Weight (g)\") +\n  theme(legend.title = element_blank())\n\n\n\n\nFigure 2: Compares true lizards weights (red) in comparison to SV Length. The weights predicted by the Male Whiptail Model (yellow ) and the All Lizards Model (blue line) = previously shown in Figure 1 represent the populations in which these models were trained upon. Statistical analysis reveals that the Male-Whiptails Model better predicts actual weights (RMSE = 3.35) better than the All Lizards Model, (RMSE = 3.56). Given the lower RMSE of the Male-Whiptails Model, when predicting Weight as a function of SV Length, models based upon the Male Western Whiptail population are preferred.\nData Citation Lightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative. https://doi.org/10.6073/pasta/4a6e258fb49c31e222ecbbcfd128967f\n\n\n\n",
    "preview": "posts/2022-03-14-project3/project3_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-03-14T16:02:21-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-14-project4/",
    "title": "PCA On Global Climate Data",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Logan Ossentjuk",
        "url": {}
      }
    ],
    "date": "2022-03-14",
    "categories": [],
    "contents": "\nOverview:\nThis brief examines variables affecting climate from nearly 230 countries . The data is subsetted to identify key interest variables before running a principle component analysis. The results of this analysis demonstrate relationships and correlations between chosen variables. The results are then shown in a biplot and conclusions are drawn.\nData Citation: Compiled and provided by @zander_venter on Kaggle, (all data acquired via Google Earth Engine https://earthengine.google.com/)\n\n\ncode\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(here)\nlibrary(ggfortify)\nlibrary(patchwork)\n\n\n\n\n\ncode\n\n### Data Wrangling and Subsetting\nworld_env <- read_csv(here('_posts', 'data', 'world_env_vars.csv')) %>% \n  clean_names() %>% \n  drop_na()\n\nworld_env_sub <- world_env %>% \n  select(country, accessibility_to_cities, cropland_cover, tree_canopy_cover, rain_mean_annual,temp_annual_range, temp_mean_annual, temp_seasonality, wind, cloudiness, elevation) %>% \n  rename(\n    \"Country\" = country,\n    \"Accessibility To Cities\" = accessibility_to_cities,\n    \"Elevation\" = elevation,\n    \"Cropland Cover\" = cropland_cover,\n    \"Tree Canopy Cover\" = tree_canopy_cover,\n    \"Annual Mean Rainfall\" = rain_mean_annual,\n    \"Annual Temperature Range\" = temp_annual_range,\n    \"Annual Mean Temperature\" = temp_mean_annual,\n    \"Temperature Seasonality\" = temp_seasonality,\n    \"Wind\" = wind, \n    \"Cloudiness\" = cloudiness)\n\n\n###Creating PCA set\nworld_env_pca <- world_env_sub %>% \n  select(-Country) %>% \n  scale() %>% #scales variables based on ranges onto the same spectrum\n  prcomp(scale = TRUE)\n\n\n#world_env_pca\n\n\n\nPCA Analysis\n\n\ncode\n\nautoplot(world_env_pca, \n         data = world_env_sub, \n         loadings = TRUE,\n         colour = 'darkgreen',\n         loadings.label = TRUE,\n         loadings.colour = 'goldenrod3',\n         loadings.label.colour = 'black',\n         loadings.label.vjust = -0.5) + \n        #scale_color_manual(values = c('blue', 'purple', 'orange')) +\n        theme_void()\n\n\n\n\nFigure 1.  Illustrates principle components analysis results of the acquired climate data. Each country is shown by a green dot. Orange arrows demonstrate chosen variables of interest where increased arrow length denotes an increased role in explaining the variation within this data set.\nSummary of Findings:\nCloudiness and Wind are negatively correlated while Cloudiness, Tree Canopy Cover, and Annual Mean Rainfall are all positively correlated. It makes sense that wind and cloudiness would negatively correlated as increased wind would decrease cloudiness. It is also logical that with increased Annual Mean Rainfall, Tree Canopy Cover would increase as plants provided with ample water will grow more lush. It is interesting here as well that Cropland Cover and Accessibility to Cities are negatively correlated. This is likely due to differing land use, where cropland is often outside of cities. However, given the poor strength of accessibility to cities, in PCA 1 or 2 it is difficult to infer this relationship based on the data.\nOther general findings: \nTree Canopy Cover and Accessibility to Cities are negatively correlated along with Wind. This likely points to the role of deforestation in building cities and the resultant increase in Wind resulting from a smoother land surface \nCropland Cover and Annual Mean Temperature are negatively correlated, possibly pointing toward a middle ground temperature that cropland is most abundant. \nTemperature Seasonality and Elevation are relatively positively correlated, pointing toward weather trends that shift as elevation increases.\n\nTree canopy was positively correlated mean and wettest month rainfall, while negatively correlated with temperature seasonality and temperature range. This aligns with our knowledge that trees need a high level of precipitation to thrive. While we cannot infer causality from the correlation, it raises an interesting questions about if the presence of forests serves as a buffer against temperature extremes or if temperature extremes undermine trees’ survivability. - Driest month of rainfall was negatively correlated with temperature range, perhaps pointing to the fact that desert-like environments have large temperature swings throughout the day. - Rain seasonality was almost completely unrelated to temperature seasonality. - The variation in accessibility to cities was not captured very well by PCA 1 or PCA 2, indicating a weak relationship between accessibility to cities and the other variables analyzed.\n\n\n\n",
    "preview": "posts/2022-03-14-project4/project4_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-14T16:03:01-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-14-test/",
    "title": "test",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Logan Ossentjuk",
        "url": {}
      }
    ],
    "date": "2022-03-14",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-14T14:52:57-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-14-test2/",
    "title": "Willamette Falls Time Series Analysis",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Logan Ossentjuk",
        "url": {}
      }
    ],
    "date": "2022-03-14",
    "categories": [],
    "contents": "\nOverview\nThis report visualizes data collected from Columbia Barin Research’s Data Access in Real Time (DART). The data utilizes is a collection of fish passages through the Willamette Falls Fish Ladder organized by species from 2001-2010. A time series is created for Coho, Jack Coho, and Steelhead salmon to understand how their population runs have changed over time. A season plot is shown to demonstrate their differing run times. Lastly, annual counts are shown to demonstrate how population abundance shifted over a ten year period.\nWillamette Falls, 2014. Photo by: Yuxing Zheng, Metro NewsWillamette Fish Ladder, 2012. Photo by: mapking, GeocachingData Citation: DART Adult Passage Graphics & Text | Columbia Basin Research. (2012). http://www.cbr.washington.edu/dart/query/adult_graph_text # Findings {.tabset .tabset-fade}\nData Preparation\n\n\ncode\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(tsibble)\nlibrary(feasts)\nlibrary(slider)\nlibrary(patchwork)\nlibrary(prettydoc)\nlibrary(paletteer)\n\n\n\n\n\ncode\n\n### Data Wrangling \nwillamette_fish <- read_csv(here('_posts', 'data', 'willamette_fish_passage.csv')) %>% \n  clean_names() \n  \nfish_sub <- willamette_fish %>% \n  mutate(date = mdy(date)) %>%\n  as_tsibble(key = NULL, index = date)  %>% \n  select(date, steelhead, coho, jack_coho, ) %>% \n  replace_na(list(steelhead = 0, coho = 0, jack_coho = 0))\n  \nfish_ts <- fish_sub %>% \n  pivot_longer(cols = c(steelhead, coho, jack_coho),\n               names_to = 'species',\n               values_to = 'count') %>%\n  mutate(species = case_when(\n    species == 'coho' ~ 'Coho',\n    species == 'jack_coho' ~ 'Jack Coho',\n    species == 'steelhead' ~ 'Steelhead'))\n\n\n\nFish Passage Time Series\n\n\ncode\n\n#Visualization \ncoho_ts <- ggplot(data = fish_sub, aes(x = date, y = coho)) +\n  geom_line(color = 'darkslategrey') +\n  theme_classic() +\n  labs(y = \"Coho\",\n       x= \"Date\")\njack_coho_ts <-ggplot(data = fish_sub, aes(x = date, y = jack_coho)) +\n  geom_line(color = 'lightgoldenrod4') +\n  theme_classic() +\n  labs(y = \"Jack Coho\",\n       x= \"Date\")\nsteelhead_ts <- ggplot(data = fish_sub, aes(x = date, y = steelhead)) +\n  geom_line(color = 'deeppink4') +\n  theme_classic() +\n  labs(y = \"Steelhead\",\n       x= \"Date\")\n\ncoho_ts/jack_coho_ts/steelhead_ts\n\n\n\n\nFigure 1. Original time series of Coho, Jack Coho and Steelhead salmon through the Willamette Fish Ladder from 2001 to 2010.\nConclusions:\nPassage is relatively consistent across this 10 year period for all species.\nJack Coho passages appear to be declining while Coho and Steelhead passages are increasing.\n2008 Appears to be a significant year for this shift between Jack Coho and Coho.\nAverage abundance of Steelhead doubles that of Jack Coho, while Steelhead abundances became half as large as Coho in between 2008 and 2010.\nSeasonplots\n\n\ncode\n\nfish_per_month <- fish_ts %>% \n  index_by(month = ~yearmonth(.)) %>% \n  group_by(species) %>% \n  summarize(monthly_sum = sum(count, na.rm = TRUE)) %>% \n  mutate(year = year(month))\n\nfish_per_month %>% \ngg_season(y = monthly_sum,\n          pal = paletteer_c(palette = \"ggthemes::Orange-Blue Diverging\", n = 10)) +\n  theme_light() +\n  labs(x = \"Month\",\n       y = \"Fish Passages\",\n       color=\"Year\") \n\n\n\n\nFigure 2: Seasonplot of Coho, Jack Coho and Steelhead. There is an obvious seasonality here, exhibiting niche tradeoffs.\nConclusions:\nCoho and Jack Coho compete for resources as their runs match up between August and November\nSteelhead have a longer but opposite run season ranging from January to August\nThere is a key niche tradeoff here as species have shifted their spawning seasons to maximize their potential of reaching spawning grounds up river with minimal competition.\nAnnual Counts By Species:\n\n\ncode\n\nfish_annual <- fish_ts %>% \n  index_by(year = ~year(.)) %>% \n  group_by(species) %>% \n  summarize(annual_counts = sum(count))\n\nsteelhead_annual <- fish_annual %>%\n  filter(species %in% c(\"Steelhead\"))\n\ncoho_annual <- fish_annual %>%\n  filter(species %in% c(\"Coho\"))\n\njack_coho <- fish_annual %>%\n  filter(species %in% c(\"Jack Coho\"))\n\nsteelhead <- ggplot(data = steelhead_annual, aes(x = year, y = annual_counts)) +\n  geom_line(color = 'deeppink4') +\n  theme_light() +\n  labs(x = \"Year\",\n       y = \"Annual Counts\",\n       title = \"Steelhead\") +\n  theme(axis.text.x = element_text(angle=45, hjust=1)) +\n    scale_x_continuous(n.breaks = 8)\n\ncoho <- ggplot(data = coho_annual, aes(x = year, y = annual_counts)) +\n  geom_line(color = 'darkslategrey') +\n  theme_light() +\n  labs(x = \"Year\",\n       y = \"Annual Counts\",\n       title = \"Coho\") +\n theme(axis.text.x = element_text(angle=45, hjust=1)) +\n    scale_x_continuous(n.breaks = 8)\n\njack_coho <- ggplot(data = jack_coho, aes(x = year, y = annual_counts)) +\n  geom_line(color = 'lightgoldenrod4') +\n  theme_light() +\n  labs(x = \"Year\",\n       y = \"Annual Counts\",\n       title = \"Jack Coho\") +\n  theme(axis.text.x = element_text(angle=45, hjust=1)) +\n    scale_x_continuous(n.breaks = 8)\n\n p4 <- ggplot(data = fish_annual, \n       aes(x = year, y = annual_counts, color = species)) +  \n  geom_line() +\n  theme_light() +\n  scale_x_continuous(n.breaks = 8) +\n  theme(legend.title = element_blank(),\n        axis.text.x = element_text(angle=45, hjust=1),\n        legend.position = 'NULL') +\n  scale_color_manual(values = c(\"darkslategrey\", \"lightgoldenrod4\", \"deeppink4\")) +  \n   #\"darkslategrey\", \"lightgoldenrod4\", \"deeppink4\"\n  labs(x = \"Year\", y = \"Annual Counts\")\n \n (coho+jack_coho+steelhead)/p4\n\n\n\n\nFigure 3 Annual Fish Ladder Counts from 2001 to 2010. Figures are split to show individual trends as well as overall population changes over time. The relationship between Jack Coho and Coho is of particular importance here. It is also worth noting the overall decline in Steelhead.\nConclusions:\nSteelhead populations have been in decline over this period but saw a signficant bounceback between 2009 and 2010.\nCoho saw a significant population boom between 2008 and 2010, growing by a factor of 5 over this short period\nJack Coho while in lower abundance have maintained a relatively consistent count across years. They also experiences a massive boom between 2008 and 2010, but it seems this returned that back to normal levels while Coho boomed above previously seen levels during this period.\nThese trends worth following up on with further research to determine their plasticity and longevity. Especially as it relates to the competition between Coho and Jack Coho as overgrowth of Coho could competitively exclude Jack Coho.\n\n\n\n",
    "preview": "posts/2022-03-14-test2/test2_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-14T16:04:12-07:00",
    "input_file": {}
  }
]
